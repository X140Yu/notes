# 0x02 ç¼–å†™ç¬¬ä¸€ä¸ª Ruby gem


## åè¯è§£é‡Š

### ä»€ä¹ˆæ˜¯ [gem](https://rubygems.org/)

æ¯ç§è¯­è¨€éƒ½æœ‰è‡ªå·±çš„åŒ…ç®¡ç†å·¥å…·ï¼Œæ¯”å¦‚ JavaScript ä½¿ç”¨ yarn/npmï¼ŒPython ä½¿ç”¨ pip ç­‰ç­‰

Ruby çš„åŒ…ç®¡ç†å·¥å…·æ˜¯ gemã€‚ä¸€ä¸ª gem ç›¸å½“äºä¸€ä¸ªåŒ…å« ruby ä»£ç çš„åŒ…ï¼Œæ¯”å¦‚æˆ‘ä»¬ç†ŸçŸ¥çš„ CocoaPods å°±æ˜¯ä¸€ä¸ª gem

#### [gemspec](https://guides.rubygems.org/specification-reference/)

å†™è¿‡ podspec å°±ä¸€å®šçŸ¥é“ä»€ä¹ˆæ˜¯ gemspecï¼Œå®ƒå°±æ˜¯ä¸€å¨ Ruby ä»£ç ï¼Œç”¨äºæè¿° gem çš„åå­—ï¼Œä¾èµ–å…³ç³»ç­‰ç­‰

é€šè¿‡æŸ¥çœ‹ [CocoaPods](https://github.com/CocoaPods/CocoaPods/blob/master/cocoapods.gemspec) çš„ gemspec æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå®ƒä¾èµ– claideï¼Œxcodeproj ç­‰ gem

### ä»€ä¹ˆæ˜¯ [bundler](https://bundler.io/)

bundler æ˜¯ç”¨æ¥ç®¡ç†é¡¹ç›® gem ä¾èµ–çš„ã€‚é€šè¿‡å®ƒæä¾›çš„[ä¸€ç³»åˆ—å‘½ä»¤](https://bundler.io/docs.html)ï¼Œ å¯ä»¥å¾ˆè½»æ¾åœ°å¯¹åŒ…å« [Gemfile](https://bundler.io/gemfile.html) çš„é¡¹ç›®è¿›è¡Œ gem çš„å®‰è£…ï¼Œæ›´æ–°

æˆ–è€…é€šè¿‡ `bundle gem $NAME` åˆ›å»ºä¸€ä¸ªæ–°çš„ gem

### ç¼–å†™ç¬¬ä¸€ä¸ª gem

ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„æ —å­ï¼Œæ¥å®è·µä¸€ä¸‹å¦‚ä½•é€šè¿‡ Ruby gem åˆ›å»ºä¸€ä¸ªç®€å•çš„ [CLI](https://en.wikipedia.org/wiki/Command-line_interface)

è¿™ä¸ªå‘½ä»¤å®ç°çš„åŠŸèƒ½ç±»ä¼¼äº *nix ä¸­çš„ `ls`ï¼Œæ‰“å°å‡ºå½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶

#### åˆ›å»º gem

æŠŠè¿™ä¸ªå‘½ä»¤èµ·åä¸º mylsï¼Œé€šè¿‡æ‰§è¡Œ `bundle gem --bin myls` åˆ›å»ºå‡ºæ•´ä¸ª gem çš„ç»“æ„ï¼Œ`â€“bin` å‚æ•°ä¼šè®© bundler è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªä¸ gem name åŒåçš„å‘½ä»¤

![image-20180914141952700](./assets/image-20180914141858411.png)


#### å®‰è£…ä¾èµ–

bundler ç”Ÿæˆçš„é¡¹ç›®é»˜è®¤ä¼šå¸¦æœ‰å‡ ä¸ª development ä¾èµ–ï¼Œå¯ä»¥é€šè¿‡ `bundle install` æ¥å®‰è£…è¿™äº›ä¾èµ–

ä½†åœ¨è¿™ä¹‹å‰ï¼Œéœ€è¦å°† myls.gemspec ä¸­çš„ TODO éƒ½åˆ æ‰ï¼Œhomepage æ”¹ä¸ºæ­£ç¡®çš„ URL æ¯”å¦‚ [https://zhihu.com](https://zhihu.com/)  ä¸ç„¶ä¼šå‡ºç°ä¸‹é¢çš„é”™è¯¯

![image-20180914141952700](./assets/image-20180914141952700.png)

ä¸‹é¢æ˜¯ä¿®æ”¹å®Œæˆåæ‰§è¡Œ `bundle install` çš„è¾“å‡ºï¼Œ

![image-20180914142000944](./assets/image-20180914142000944.png)


#### ç¼–å†™ä»£ç 

éœ€è¦å…³æ³¨çš„æ–‡ä»¶æœ‰ï¼Œ

* `exe/myls` æ­¤æ–‡ä»¶ä½œä¸º `myls` å‘½ä»¤çš„å…¥å£ï¼Œåœ¨å‘½ä»¤è¡Œæ‰§è¡Œ `myls` æ—¶ï¼Œæ­¤æ–‡ä»¶ä¼šè¢«æ‰§è¡Œ
* `lib/myls.rb` çœŸæ­£å®ç° `myls` å‘½ä»¤çš„åœ°æ–¹

åœ¨ `lib/myls.rb` ä¸­ç¼–å†™å¦‚ä¸‹çš„ä»£ç ï¼Œå°±æ˜¯ç®€å•åœ°ä½¿ç”¨ `Dir.glob` æ–¹æ³•è¾“å‡ºå½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶

```ruby
require "myls/version"
 
module Myls
  def self.ls
    puts Dir.glob '*'
  end
end
```

ç„¶åè·³åˆ° `exe/myls` æ–‡ä»¶ä¸­ï¼Œè°ƒç”¨è¯¥æ–¹æ³•ï¼Œ

```ruby
#!/usr/bin/env ruby
 
# è¿™é‡Œ require çš„æ˜¯ `lib/myls(.rb)`
require "myls"
 
Myls.ls
```

è‡³æ­¤ï¼Œæˆ‘ä»¬ç®€å•ç‰ˆæœ¬çš„ `ls` å·²ç»å®Œæˆäº†

æ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•

#### å®‰è£…

åœ¨ç¼–å†™å®Œæˆåï¼Œé€šè¿‡ `rake install` å®‰è£…ç¼–å†™å¥½çš„ gem åˆ°æœ¬åœ°çš„ç”µè„‘ä¸­

![image-20180914142021484](./assets/image-20180914142021484.png)

ç„¶åç»§ç»­è¾“å…¥å‘½ä»¤ `myls` å°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åˆšåˆšç¼–å†™å¥½çš„ä»£ç äº§ç”Ÿçš„æ•ˆæœå•¦ï¼ŒğŸ˜

![image-20180914142027658](./assets/image-20180914142027658.png)


#### å¸è½½

gem uninstall myks
